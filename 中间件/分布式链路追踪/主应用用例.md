maven

```
<dependency>
    <groupId>io.jaegertracing</groupId>
    <artifactId>jaeger-client</artifactId>
    <version>1.2.0</version>
</dependency>

<dependency>
    <groupId>io.jaegertracing</groupId>
    <artifactId>jaeger-core</artifactId>
    <version>1.2.0</version>
</dependency>
```

网关用例

```
package com.nascent.devops.gateway.config.proxy;
import com.nascent.devops.gateway.constants.BeanNameConstants;
import com.nascent.devops.gateway.filter.AccessLogFilter;
import com.nascent.devops.gateway.filter.AuthFilter;
import com.nascent.devops.gateway.filter.SignatureFilter;
import com.nascent.devops.gateway.model.bo.route.GatewayRouteDefinition;
import com.nascent.devops.gateway.model.sys.AppInfo;
import com.nascent.devops.gateway.service.route.RouteServiceImpl;
import io.opentracing.Span;
import io.opentracing.SpanContext;
import io.opentracing.propagation.Format;
import io.opentracing.propagation.TextMapAdapter;
import io.opentracing.util.GlobalTracer;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.cloud.gateway.filter.FilterDefinition;
import org.springframework.cloud.gateway.route.RouteLocator;
import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.server.ServerWebExchange;

import java.io.UnsupportedEncodingException;
import java.util.*;

@Configuration
public class DevopsConfig {


    io.jaegertracing.Configuration tracerConfig = new io.jaegertracing.Configuration("0527");
    io.jaegertracing.Configuration.SenderConfiguration sender = new io.jaegertracing.Configuration.SenderConfiguration();

  

    @Bean
    @Qualifier(BeanNameConstants.REDIS_BEAN)
    public RouteLocator test(RouteLocatorBuilder builder) throws UnsupportedEncodingException {



        return builder.routes().route(r -> r.path("/menu/**").filters(f -> f.filter( ( exchange, chain ) -> {
                    sender.withAgentHost("UPD上报地址");
                    sender.withAgentPort(5775);
                    tracerConfig.withReporter(new io.jaegertracing.Configuration.ReporterConfiguration().withSender(sender).withFlushInterval(100).withLogSpans(false));
                    tracerConfig.withSampler(new io.jaegertracing.Configuration.SamplerConfiguration().withType("const").withParam(1));
                    io.opentracing.Tracer tracer = tracerConfig.getTracer();
                    GlobalTracer.register(tracer);
                    Span parent = GlobalTracer.get().buildSpan("spring-cloud-gateway").start();
                    Map<String,String> map = new HashMap<>();
//                    tracer.activateSpan(parent);
                    SpanContext spanContext = parent.context();
                    String id =  String.format("%s:%s:%s:%s",spanContext.toTraceId(),spanContext.toSpanId(),spanContext.toTraceId(),(int) Math.ceil(Math.random()*100));
                    map.put("uber-trace-id",id);
                    GlobalTracer.get().inject(spanContext, Format.Builtin.TEXT_MAP, new TextMapAdapter(map));
                    parent.log("经过网关-spring cloud gateway");
                    parent.log(100, id);
                    parent.finish();

            ServerWebExchange reBuildExchange = exchange.mutate().request(exchange.getRequest().mutate().header("uber-trace-id",id).build()).build();
            return chain.filter(reBuildExchange);

        }))
                        .uri("http://127.0.0.1:9002")
                ).build();
    }
}
```